(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{33:function(e,t,a){e.exports=a(34)},34:function(e,t,a){"use strict";a.r(t);var n=a(9),r=a(10),i=a(1),s=a(12),l=a(11),o=a(0),c=a.n(o),u=a(31),d=a.n(u),m=a(16),h=a(2),g=(a(39),a(4)),p=a.n(g),f=a(14),b=a.n(f);var E=function(e){Object(s.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).toHome=r.toHome.bind(Object(i.a)(r)),r.toListings=r.toListings.bind(Object(i.a)(r)),r.toMealPlanner=r.toMealPlanner.bind(Object(i.a)(r)),r.toAdminListings=r.toAdminListings.bind(Object(i.a)(r)),r.logout=r.logout.bind(Object(i.a)(r)),r.state={redirect:""},r}return Object(r.a)(a,[{key:"toHome",value:function(e){e.preventDefault(),this.followLink("/")}},{key:"toListings",value:function(e){e.preventDefault(),this.followLink("/listings")}},{key:"toMealPlanner",value:function(e){e.preventDefault(),this.followLink("/newplan")}},{key:"toAdminListings",value:function(e){e.preventDefault(),this.followLink("/adminlistings")}},{key:"logout",value:function(e){e.preventDefault(),this.followLink("/login")}},{key:"followLink",value:function(e){console.log("redirecting to ".concat(e)),e!==this.props.here&&this.setState({redirect:e})}},{key:"render",value:function(){return this.state.redirect?c.a.createElement(h.a,{to:{pathname:this.state.redirect,state:{token:this.props.token}}}):c.a.createElement("div",null,c.a.createElement("div",{class:"pb-2 mt-4 mb-2 border-bottom"},c.a.createElement("h1",null,"The MeelReel")),c.a.createElement("nav",{class:"nav nav-tabs"},c.a.createElement("a",{class:"nav-link",href:"/",onClick:this.toHome},"Home"),c.a.createElement("a",{class:"nav-link",href:"/newplan",onClick:this.toMealPlanner},"New Meal Plan"),c.a.createElement("a",{class:"nav-link",href:"/listings",onClick:this.toListings},"Listings"),c.a.createElement("a",{class:"nav-link",href:"/adminlistings",onClick:this.toAdminListings},"Admin listings"),c.a.createElement("a",{class:"nav-link",href:"/login",onClick:this.logout},"Log out")))}}]),a}(c.a.Component),v=function(e){Object(s.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).state={username:"",password:"",redirect:"",token:""},r.props.location.state&&r.props.location.state.token&&(r.state.token=r.props.location.state.token),r.handleUsernameChange=r.handleUsernameChange.bind(Object(i.a)(r)),r.handlePasswordChange=r.handlePasswordChange.bind(Object(i.a)(r)),r.handleSubmit=r.handleSubmit.bind(Object(i.a)(r)),r}return Object(r.a)(a,[{key:"handleUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"handlePasswordChange",value:function(e){this.setState({password:e.target.value})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),p()({method:"get",url:"/api/login",auth:{username:this.state.username,password:this.state.password}}).then((function(e){console.log("logged in!"),t.setState({redirect:"/",token:e.data.token})})).catch((function(e){console.log(e.data),t.setState({error:e.statusText})}))}},{key:"render",value:function(){if(this.state.redirect)return console.log("redirecting to ".concat(this.state.redirect)),c.a.createElement(h.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}});var e=this.state.error?c.a.createElement("p",null,this.state.error):c.a.createElement("p",null);return c.a.createElement("div",null,c.a.createElement("br",null),c.a.createElement("div",{class:"jumbotron title"},c.a.createElement("h1",{class:"display-4"},"The MeelReel"),c.a.createElement("p",{class:"lead"},"Created By ",c.a.createElement("a",{href:"https://wiki.illinois.edu/wiki/display/CS411SU20/Big+Data+Energy",target:"_blank"},"Big Data Energy"))),c.a.createElement("div",{class:"jumbotron"},c.a.createElement("div",{class:"container"},c.a.createElement("div",{class:"row"},c.a.createElement("div",{class:"col-md-6 cols"},c.a.createElement("h4",null,"What is The MeelReel?"),c.a.createElement("p",null,"The MeelReel is a web application that generates meal plans for a specified interval. Its primary feature is its budget filter; you can enter the maximum amount of money you want to spend on food for the specified interval and your desired caloric intake, and the application generates a meal plan in your budget.")),c.a.createElement("div",{class:"col-md-6 cols"},c.a.createElement("h4",null,"Sign In"),e,c.a.createElement("form",{class:"container login_div",onSubmit:this.handleSubmit},c.a.createElement("input",{type:"text",id:"username",class:"form-control",value:this.state.username,onChange:this.handleUsernameChange,placeholder:"Username",required:!0,autofocus:""}),c.a.createElement("br",null),c.a.createElement("input",{type:"password",id:"password",class:"form-control",value:this.state.password,onChange:this.handlePasswordChange,placeholder:"Password",required:!0}),c.a.createElement("br",null),c.a.createElement("button",{class:"btn btn-primary",type:"submit"},"Go To Your MeelReel"),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("p",null,"Don't have an account? ",c.a.createElement(m.b,{to:"/newaccount"},"Sign up"))))))),c.a.createElement("footer",{id:"sticky-footer",class:"jumbotron py-4 text-white-50"},c.a.createElement("div",{class:"container text-center",id:"footer-text"},c.a.createElement("small",null,"Copyright \xa9 2020 ",c.a.createElement("a",{href:"https://wiki.illinois.edu/wiki/display/CS411SU20/Big+Data+Energy",target:"_blank"},"Big Data Energy")))))}}]),a}(c.a.Component),y=function(e){Object(s.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).state={username:"",password1:"",password2:"",redirect:""},r.handleUsernameChange=r.handleUsernameChange.bind(Object(i.a)(r)),r.handlePassword1Change=r.handlePassword1Change.bind(Object(i.a)(r)),r.handlePassword2Change=r.handlePassword2Change.bind(Object(i.a)(r)),r.handleSubmit=r.handleSubmit.bind(Object(i.a)(r)),r}return Object(r.a)(a,[{key:"handleUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"handlePassword1Change",value:function(e){this.setState({password1:e.target.value})}},{key:"handlePassword2Change",value:function(e){var t=e.target.value;this.setState((function(e,a){var n=e.password1!==t?"Passwords must match":"";return{password2:t,smallError:n}}))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.state.username?this.state.password1===this.state.password2?this.state.password1?p()({method:"get",url:"/api/createaccount",auth:{username:this.state.username,password:this.state.password1}}).then((function(e){console.log("redirecting to /"),t.setState({redirect:"/",token:e.data.token})})).catch((function(e){t.setState({error:e.statusText})})):this.setState({smallError:"No password provided"}):this.setState({smallError:"Passwords must match"}):this.setState({smallError:"No username provided"})}},{key:"render",value:function(){if(this.state.redirect)return c.a.createElement(h.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}});var e=this.state.error?c.a.createElement("p",null,this.state.error):c.a.createElement("p",null),t=this.state.smallError?c.a.createElement("p",null,this.state.smallError):c.a.createElement("p",null);return c.a.createElement("div",null,c.a.createElement("br",null),c.a.createElement("div",{class:"jumbotron title"},c.a.createElement("h1",{class:"display-4"},"The MeelReel"),c.a.createElement("p",{class:"lead"},"Created By ",c.a.createElement("a",{href:"https://wiki.illinois.edu/wiki/display/CS411SU20/Big+Data+Energy",target:"_blank"},"Big Data Energy"))),c.a.createElement("div",{class:"jumbotron"},c.a.createElement("h4",null,"Sign Up"),e,c.a.createElement("form",{class:"container login_div",onSubmit:this.handleSubmit},c.a.createElement("input",{type:"text",id:"username",class:"form-control",value:this.state.username,onChange:this.handleUsernameChange,placeholder:"Username",required:!0,autofocus:""}),c.a.createElement("br",null),c.a.createElement("input",{type:"password",id:"password1",class:"form-control",value:this.state.password1,onChange:this.handlePassword1Change,placeholder:"Password",required:!0}),c.a.createElement("br",null),c.a.createElement("input",{type:"password",id:"password2",class:"form-control",value:this.state.password2,onChange:this.handlePassword2Change,placeholder:"Retype Password",required:!0}),c.a.createElement("br",null),c.a.createElement("button",{type:"submit",class:"btn btn-primary"},"Create account"),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("p",null,"Already have an account? ",c.a.createElement(m.b,{to:"/login"},"Log in"))),t),c.a.createElement("footer",{id:"sticky-footer",class:"jumbotron py-4 text-white-50"},c.a.createElement("div",{class:"container text-center",id:"footer-text"},c.a.createElement("small",null,"Copyright \xa9 2020 ",c.a.createElement("a",{href:"https://wiki.illinois.edu/wiki/display/CS411SU20/Big+Data+Energy",target:"_blank"},"Big Data Energy")))))}}]),a}(c.a.Component);function k(e){return c.a.createElement("div",{class:"card"},c.a.createElement("img",{class:"card-img-top",src:e.imageURL,alt:e.name}),c.a.createElement("div",{class:"card-body"},c.a.createElement("h5",{class:"card-title"},e.name),c.a.createElement("div",{class:"container"},c.a.createElement("p",{class:"card-text row"},c.a.createElement("div",{class:"col"},"Calories: ",e.calories),c.a.createElement("div",{class:"col"},"Cost: $",e.cost))),c.a.createElement("a",{href:e.recipeURL,class:"btn btn-link"},"View Recipe")))}function w(e){return c.a.createElement("ul",{class:"list-group"},e.meals.map((function(e,t){return c.a.createElement("li",{key:t,class:"list-group-item"},c.a.createElement(k,{name:e.name,imageURL:e.imageURL,recipeURL:e.recipeURL,cost:e.cost,calories:e.calories}))})))}function S(e){return c.a.createElement("div",{class:"card"},c.a.createElement("div",{class:"card-body"},c.a.createElement("h5",{class:"card-title"},e.name),c.a.createElement("div",{class:"container"},c.a.createElement("p",{class:"card-text row"},c.a.createElement("div",null,"Created ",e.timeCreated),c.a.createElement("div",null,"Cost: $",e.totalCost),c.a.createElement("div",null,"Total Calories: ",e.totalCalories," (",e.totalCalories/e.recipes.length," calories per day)"))),c.a.createElement("hr",null),c.a.createElement("div",{class:"d-flex flex-wrap"},e.recipes.map((function(e,t){return c.a.createElement("div",{key:t},c.a.createElement(w,{meals:e}))})))))}var C=function(e){Object(s.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).state={token:"",redirect:"",error:"",mealPlans:[]},r.props.location.state&&r.props.location.state.token?r.state.token=r.props.location.state.token:r.state.redirect="/login",r.fetchMealPlans(),r}return Object(r.a)(a,[{key:"fetchMealPlans",value:function(){var e=this;p()({method:"get",url:"/api/mealplan",headers:{Authorization:"Bearer ".concat(this.state.token)}}).then((function(t){e.setState({mealPlans:t.data.results})})).catch((function(t){e.setState({error:t.data.error})}))}},{key:"deleteMealPlan",value:function(e){var t=this;p()({method:"delete",url:"/api/mealplan",headers:{Authorization:"Bearer ".concat(this.state.token)},data:{id:e}}).then((function(e){t.fetchMealPlans()})).catch((function(e){t.setState({error:e.data.error})}))}},{key:"render",value:function(){var e=this;return this.state.redirect?c.a.createElement(h.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}}):c.a.createElement("div",null,c.a.createElement(E,{token:this.state.token,here:this.props.location.pathname}),c.a.createElement("h3",null,"Your existing meal plans:"),c.a.createElement("ul",{class:"list-group list-group-flush"},this.state.mealPlans.map((function(t){return c.a.createElement("li",{key:t.id,class:"list-group-item"},c.a.createElement(S,{name:t.name,timeCreated:t.timeCreated,totalCost:t.totalCost,totalCalories:t.totalCalories,recipes:t.recipes}),c.a.createElement("br",null),c.a.createElement("a",{class:"btn btn-link",href:"/api/mealplan/".concat(t.id,".pdf"),download:!0},"Download"),c.a.createElement("button",{class:"btn btn-danger",onClick:function(){return e.deleteMealPlan(t.id)}},"Delete"))}))))}}]),a}(c.a.Component),I=function(e){Object(s.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),console.log("constructing plan meal page"),(r=t.call(this,e)).state={token:"",redirect:"",error:"",msg:"",budget:0,days:0,dailyCalories:0,title:"",minIngredients:[],maxIngredients:[],newIngredient:"",newAmount:0,newUnits:"",ingredientSearchResults:[],unitSearchResults:[],ingredientKeyword:"",unitKeyword:""},r.props.location.state&&r.props.location.state.token?r.state.token=r.props.location.state.token:r.state.redirect="/login",r.submitPlan=r.submitPlan.bind(Object(i.a)(r)),r.setTitle=r.setTitle.bind(Object(i.a)(r)),r.setBudget=r.setBudget.bind(Object(i.a)(r)),r.setCalories=r.setCalories.bind(Object(i.a)(r)),r.setDays=r.setDays.bind(Object(i.a)(r)),r.updateIngredientSearch=r.updateIngredientSearch.bind(Object(i.a)(r)),r.updateUnitSearch=r.updateUnitSearch.bind(Object(i.a)(r)),r.addMinIngredient=r.addMinIngredient.bind(Object(i.a)(r)),r.deleteMinIngredient=r.deleteMinIngredient.bind(Object(i.a)(r)),r.addMaxIngredient=r.addMaxIngredient.bind(Object(i.a)(r)),r.deleteMaxIngredient=r.deleteMaxIngredient.bind(Object(i.a)(r)),r.setIngredient=r.setIngredient.bind(Object(i.a)(r)),r.setUnits=r.setUnits.bind(Object(i.a)(r)),r.setAmount=r.setAmount.bind(Object(i.a)(r)),r}return Object(r.a)(a,[{key:"setTitle",value:function(e){this.setState({title:e.target.value})}},{key:"setBudget",value:function(e){this.setState({budget:e.target.value})}},{key:"setCalories",value:function(e){this.setState({dailyCalories:e.target.value})}},{key:"setDays",value:function(e){this.setState({days:e.target.value})}},{key:"setIngredient",value:function(e){this.setState({newIngredient:e,ingredientSearchResults:[]})}},{key:"setUnits",value:function(e){this.setState({newUnits:e,unitSearchResults:[]})}},{key:"setAmount",value:function(e){this.setState({newAmount:e.target.value})}},{key:"updateIngredientSearch",value:function(e){var t=this,a=e.target.value;this.setState({ingredientKeyword:a},(function(){t.ingFn||(t.ingFn=b.a.debounce((function(){p()({method:"get",url:"/api/search/ingredient",params:{kw:t.state.ingredientKeyword},headers:{Authorization:"Bearer ".concat(t.state.token)}}).then((function(e){t.setState({ingredientSearchResults:e.data.results})}))}),400)),t.ingFn()}))}},{key:"updateUnitSearch",value:function(e){var t=this,a=e.target.value;this.setState({unitKeyword:a},(function(){t.unitFn||(t.unitFn=b.a.debounce((function(){p()({method:"get",url:"/api/search/unit",params:{kw:t.state.unitKeyword},headers:{Authorization:"Bearer ".concat(t.state.token)}}).then((function(e){t.setState({unitSearchResults:e.data.results})}))}),400)),t.unitFn()}))}},{key:"addMinIngredient",value:function(){var e=this;this.state.minIngredients.some((function(t){return t.name===e.state.newIngredient}))||this.setState((function(e,t){return e.minIngredients.push({name:e.newIngredient,amount:e.newAmount,units:e.newUnits}),{minIngredients:e.minIngredients}}))}},{key:"deleteMinIngredient",value:function(e){console.log("deleting ".concat(e," from min")),console.log(this.state.minIngredients),this.setState((function(t,a){return{minIngredients:t.minIngredients.filter((function(t){return t.name!==e}))}}))}},{key:"addMaxIngredient",value:function(){var e=this;this.state.minIngredients.some((function(t){return t.name===e.state.newIngredient}))||this.setState((function(e,t){return e.maxIngredients.push({name:e.newIngredient,amount:e.newAmount,units:e.newUnits}),{maxIngredients:e.maxIngredients}}))}},{key:"deleteMaxIngredient",value:function(e){console.log("deleting ".concat(e," from max")),console.log(this.state.maxIngredients),this.setState((function(t,a){return{maxIngredients:t.maxIngredients.filter((function(t){return t.name!==e}))}}))}},{key:"submitPlan",value:function(e){var t=this;e.preventDefault();var a={budget:this.state.budget,dailyCalories:this.state.dailyCalories,days:this.state.days,title:this.state.title,minIngredients:this.state.minIngredients,maxIngredients:this.state.maxIngredients};console.log(a),p()({method:"post",url:"/api/mealplan",headers:{Authorization:"Basic ".concat(this.state.token)},data:a}).then((function(e){t.setState({redirect:"/"})})).catch((function(e){t.setState({error:e.data.error})}))}},{key:"render",value:function(){var e=this;if(console.log("rendering plan meal page"),this.state.redirect)return console.log("redirecting"),c.a.createElement(h.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}});var t=this.state.minIngredients.map((function(t){return c.a.createElement("li",{key:t.name,class:"list-group-item"},c.a.createElement("div",{key:t.name,class:"card"},c.a.createElement("div",{class:"card-body"},c.a.createElement("p",null,t.name,": ",t.amount," ",t.units),c.a.createElement("button",{class:"btn btn-danger",onClick:function(){return e.deleteMinIngredient(t.name)}},"X"))))})),a=this.state.maxIngredients.map((function(t){return c.a.createElement("li",{key:t.name,class:"list-group-item"},c.a.createElement("div",{class:"card"},c.a.createElement("div",{class:"card-body"},c.a.createElement("p",{class:"card-text"},t.name,": ",t.amount," ",t.units),c.a.createElement("button",{class:"btn btn-danger",onClick:function(){return e.deleteMaxIngredient(t.name)}},"X"))))}));return c.a.createElement("div",null,c.a.createElement(E,{token:this.state.token,here:this.props.location.pathname}),c.a.createElement("h3",null,"Generate a new meal plan"),c.a.createElement("div",null,c.a.createElement("div",{class:"row"},c.a.createElement("div",{class:"form-group col-md-6"},c.a.createElement("label",{htmlFor:"title"},"Title (optional)"),c.a.createElement("input",{id:"title",type:"text",class:"form-control",value:this.state.title,onChange:this.setTitle})),c.a.createElement("div",{class:"form-group col-md-6"},c.a.createElement("label",{htmlFor:"budget"},"Budget"),"$",c.a.createElement("input",{id:"budget",type:"number",min:"0",step:"0.01",class:"form-control",value:this.state.budget,onChange:this.setBudget})),c.a.createElement("div",{class:"form-group col-md-6"},c.a.createElement("label",{htmlFor:"calories"},"Daily Calories"),c.a.createElement("input",{id:"calories",type:"number",min:"0",class:"form-control",value:this.state.dailyCalories,onChange:this.setCalories})),c.a.createElement("div",{class:"form-group col-md-6"},c.a.createElement("label",{htmlFor:"days"},"Days"),c.a.createElement("input",{id:"days",type:"number",min:"1",max:"31",class:"form-control",value:this.state.days,onChange:this.setDays}))),c.a.createElement("hr",null),c.a.createElement("div",{class:"row"},c.a.createElement("div",{class:"col-6"},c.a.createElement("h4",null,"Minimum Ingredients"),c.a.createElement("ul",{class:"list-group"},t)),c.a.createElement("div",{class:"col-6"},c.a.createElement("h4",null,"Maximum Ingredients"),c.a.createElement("ul",{class:"list-group"},a))),c.a.createElement("hr",null),c.a.createElement("div",{class:"form-group"},c.a.createElement("label",{htmlFor:"search-ingr"},"Ingredient"),c.a.createElement("input",{id:"search-ingr",class:"form-control",type:"text",value:this.ingredientKeyword,onChange:this.updateIngredientSearch})),c.a.createElement("ul",{class:"list-group list-group-horizontal d-flex flex-wrap"},this.state.ingredientSearchResults.map((function(t){return c.a.createElement("li",{key:t,class:"list-group-item"},c.a.createElement("button",{class:"btn btn-secondary",onClick:function(){return e.setIngredient(t)}},t))}))),c.a.createElement("div",{class:"form-group"},c.a.createElement("label",{htmlFor:"search-unit"},"Unit"),c.a.createElement("input",{id:"search-unit",class:"form-control",type:"text",value:this.unitKeyword,onChange:this.updateUnitSearch})),c.a.createElement("ul",{class:"list-group list-group-horizontal d-flex flex-wrap"},this.state.unitSearchResults.map((function(t){return c.a.createElement("li",{key:t,class:"list-group-item"},c.a.createElement("button",{class:"btn btn-secondary",onClick:function(){return e.setUnits(t)}},t))}))),c.a.createElement("hr",null),c.a.createElement("div",{class:"form-row"},c.a.createElement("div",{class:"col-3"},this.state.newIngredient,": "),c.a.createElement("input",{id:"amount",class:"form-control col-8",type:"number",min:"0",step:"0.01",value:this.state.newAmount,onChange:this.setAmount}),c.a.createElement("div",{class:"col-1"},this.state.newUnits)),c.a.createElement("div",{class:"form-group"},c.a.createElement("button",{class:"btn btn-dark",onClick:this.addMinIngredient},"Add as minimum"),c.a.createElement("button",{class:"btn btn-light",onClick:this.addMaxIngredient},"Add as maximum")),c.a.createElement("button",{class:"btn btn-primary",onClick:this.submitPlan},"Create Plan")))}}]),a}(c.a.Component),j=function(e){Object(s.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),console.log("constructing price listings"),(r=t.call(this,e)).state={ingredientSuggestions:[],unitSuggestions:[],token:"",ingredientSearchTerm:"",unitSearchTerm:"",newIngredientName:"",newIngredientSource:"",newIngredientPrice:0,newIngredientUnits:"",redirect:"",msg:""},r.props.location.state&&r.props.location.state.token?r.state.token=r.props.location.state.token:r.state.redirect="/login",r.searchIngredient=r.searchIngredient.bind(Object(i.a)(r)),r.searchUnit=r.searchUnit.bind(Object(i.a)(r)),r.fetchNeededPriceListing=r.fetchNeededPriceListing.bind(Object(i.a)(r)),r.setPrice=r.setPrice.bind(Object(i.a)(r)),r.setAmount=r.setAmount.bind(Object(i.a)(r)),r.selectUnits=r.selectUnits.bind(Object(i.a)(r)),r.selectIngredient=r.selectIngredient.bind(Object(i.a)(r)),r.selectSource=r.selectSource.bind(Object(i.a)(r)),r.addPriceListing=r.addPriceListing.bind(Object(i.a)(r)),r}return Object(r.a)(a,[{key:"searchIngredient",value:function(e){var t=this,a=e.target.value;this.setState({ingredientSearchTerm:a},(function(){t.searchIngredientFn||(t.searchIngredientFn=b.a.debounce((function(){t.state.ingredientSearchTerm?p()({method:"get",url:"/api/search/ingredient",headers:{Authorization:"Bearer ".concat(t.state.token)},params:{kw:t.state.ingredientSearchTerm}}).then((function(e){console.log(e.data),t.setState({ingredientSuggestions:e.data.results})})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):t.setState({error:e.data.error})})):t.setState({ingredientSuggestions:[]})}),400)),t.searchIngredientFn()}))}},{key:"searchUnit",value:function(e){var t=this,a=e.target.value;this.setState({unitSearchTerm:a},(function(){t.searchUnitFn||(t.searchUnitFn=b.a.debounce((function(){t.state.unitSearchTerm?p()({method:"get",url:"/api/search/unit",headers:{Authorization:"Bearer ".concat(t.state.token)},params:{kw:t.state.unitSearchTerm}}).then((function(e){console.log(e.data),t.setState({unitSuggestions:e.data.results})})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):t.setState({error:e.data.error})})):t.setState({unitSuggestions:[]})}),400)),t.searchUnitFn()}))}},{key:"fetchNeededPriceListing",value:function(){var e=this;p()({method:"get",url:"/api/pricelistings",headers:{Authorization:"Bearer ".concat(this.state.token)}}).then((function(t){console.log(t.data),e.setState({newIngredientName:t.data.result,ingredientSuggestions:[]})})).catch((function(t){401===t.status?e.setState({redirect:"/login"}):e.setState({error:t.data.error})}))}},{key:"selectIngredient",value:function(e){this.setState({newIngredientName:e,ingredientSuggestions:[]})}},{key:"selectUnits",value:function(e){this.setState({newIngredientUnits:e,unitSuggestions:[]})}},{key:"selectSource",value:function(e){this.setState({newIngredientSource:e.target.value})}},{key:"setPrice",value:function(e){this.setState({newIngredientPrice:e.target.value})}},{key:"setAmount",value:function(e){this.setState({newIngredientAmount:e.target.value})}},{key:"addPriceListing",value:function(e){var t=this;e&&e.preventDefault();var a={ingredientName:this.state.newIngredientName,price:this.state.newIngredientPrice,amount:this.state.newIngredientAmount,source:this.state.newIngredientSource,units:this.state.newIngredientUnits};["ingredientName","source","units"].forEach((function(e){a[e]||t.setState({error:"Missing field: ".concat(e)})})),a.price<0?this.setState({error:"Price cannot be negative"}):a.amount&&a.amount<0?this.setState({error:"Amount cannot be negative"}):p()({method:"post",url:"/api/pricelistings",headers:{Authorization:"Bearer ".concat(this.state.token)},data:a}).then((function(e){t.setState({error:"",msg:"Price for ".concat(a.ingredientName," successfully added!")})})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):t.setState({error:e.data.error})}))}},{key:"render",value:function(){var e,t,a,n=this;return this.state.redirect?c.a.createElement(h.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}}):(this.state.ingredientSuggestions?e=c.a.createElement("ul",{class:"list-group list-group-horizontal d-flex flex-wrap"},this.state.ingredientSuggestions.map((function(e){return c.a.createElement("li",{key:e,class:"list-group-item"},c.a.createElement("button",{class:"btn btn-secondary",onClick:function(){return n.selectIngredient(e)}},e))}))):this.ingredientOptions="",t=this.state.unitSuggestions?c.a.createElement("ul",{class:"list-group list-group-horizontal d-flex flex-wrap"},this.state.unitSuggestions.map((function(e){return c.a.createElement("li",{key:e,class:"list-group-item"},c.a.createElement("button",{class:"btn btn-secondary",onClick:function(){return n.selectUnits(e)}},e))}))):"",a=this.state.newIngredientName&&this.state.newIngredientUnits?c.a.createElement("div",null,c.a.createElement("form",{onSubmit:this.addPriceListing},c.a.createElement("h5",null,this.state.newIngredientName),c.a.createElement("div",null,c.a.createElement("div",{class:"form-group"},c.a.createElement("label",{htmlFor:"source"},"Source"),c.a.createElement("input",{type:"text",class:"form-control",id:"source",value:this.state.newIngredientSource,onChange:this.selectSource})),c.a.createElement("div",{class:"form-group"},c.a.createElement("label",{htmlFor:"price"},"Price ($): "),c.a.createElement("input",{type:"number",class:"form-control",id:"price",min:"0",step:"0.01",value:this.state.newIngredientPrice,onChange:this.setPrice})),c.a.createElement("div",{class:"form-group"},c.a.createElement("label",{htmlFor:"amount"},"Amount (",this.state.newIngredientUnits,")"),c.a.createElement("input",{type:"number",class:"form-control",id:"amount",min:"0",step:"0.01",value:this.state.newIngredientAmount,onChange:this.setAmount}))),c.a.createElement("button",{type:"submit",class:"btn btn-primary"},"Submit"))):"",c.a.createElement("div",null,c.a.createElement(E,{token:this.state.token,here:this.props.location.pathname}),c.a.createElement("div",null,c.a.createElement("div",{class:"form-group"},c.a.createElement("label",{htmlFor:"searchIngredient"},"Search for an ingredient to add a price listing for:"),c.a.createElement("input",{id:"searchIngredient",class:"form-control",value:this.ingredientSearchTerm,onChange:this.searchIngredient}),c.a.createElement("button",{class:"btn btn-info",onClick:this.fetchNeededPriceListing},"Choose for me")),e,c.a.createElement("div",{class:"form-group"},c.a.createElement("label",{htmlFor:"searchUnit"},"Select Units"),c.a.createElement("input",{id:"searchUnit",class:"form-control",value:this.unitSearchTerm,onChange:this.searchUnit})),t),c.a.createElement("br",null),c.a.createElement("div",{class:"row"},c.a.createElement("p",{class:"col"},"New ingredient: ",this.state.newIngredientName?this.state.newIngredientName:"None"),c.a.createElement("p",{class:"col"},"New units: ",this.state.newIngredientUnits?this.state.newIngredientUnits:"None")),c.a.createElement("hr",null),a,this.state.error,this.state.msg))}}]),a}(c.a.Component),O=function(e){Object(s.a)(a,e);var t=Object(l.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).state={priceListings:[],token:"",redirect:"",ingredientKeyword:"",sourceKeyword:""},r.props.location.state&&r.props.location.state.token?r.state.token=r.props.location.state.token:r.state.redirect="/login",r.setIngredientKeyword=r.setIngredientKeyword.bind(Object(i.a)(r)),r.setSourceKeyword=r.setSourceKeyword.bind(Object(i.a)(r)),r.fetchListings(),r}return Object(r.a)(a,[{key:"fetchListings",value:function(){var e=this;this.fetchFn||(this.fetchFn=b.a.debounce((function(){p()({method:"get",url:"/api/adminpricelistings",headers:{Authorization:"Bearer ".concat(e.state.token)},params:{ingredient:e.state.ingredientKeyword,source:e.state.sourceKeyword}}).then((function(t){e.setState({priceListings:t.data.results})})).catch((function(t){401===t.status?e.setState({redirect:"/login"}):403===t.status?e.setState({error:"Not an admin"}):e.setState({error:t.data.error})}))}),400)),this.fetchFn()}},{key:"updateListing",value:function(e){var t=this;p()({method:"post",url:"/api/adminpricelistings/update",headers:{Authorization:"Bearer ".concat(this.state.token)},data:{ingredientName:e.ingredientName,source:e.source,timeCreated:e.timeCreated,price:e.price,units:e.units}}).then((function(e){t.fetchListings()})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):403===e.status?t.setState({error:"Not an admin"}):t.setState({error:e.data.error})}))}},{key:"deleteListing",value:function(e){var t=this;p()({method:"post",url:"/api/adminpricelistings/delete",headers:{Authorization:"Bearer ".concat(this.state.token)},data:{ingredientName:e.ingredientName,source:e.source,timeCreated:e.timeCreated}}).then((function(e){t.fetchListings()})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):403===e.status||t.setState({error:e.data.error})}))}},{key:"updateListingLocally",value:function(e,t,a){console.log(e),this.setState({priceListings:this.state.priceListings.map((function(n){return n.ingredientName===e.ingredientName&&n.source===e.source&&n.timeCreated===e.timeCreated?{ingredientName:n.ingredientName,source:n.source,timeCreated:n.timeCreated,price:t,units:a}:n}))})}},{key:"setIngredientKeyword",value:function(e){this.setState({ingredientKeyword:e.target.value},this.fetchListings)}},{key:"setSourceKeyword",value:function(e){this.setState({sourceKeyword:e.target.value},this.fetchListings)}},{key:"render",value:function(){var e=this;if(this.state.redirect)return console.log("redirecting"),c.a.createElement(h.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}});var t=this.state.priceListings.map((function(t){return c.a.createElement("tr",{key:"".concat(t.ingredientName,":").concat(t.source,":").concat(t.timeCreated)},c.a.createElement("td",null,t.ingredientName),c.a.createElement("td",null,"$",c.a.createElement("input",{type:"number",min:"0",step:"0.01",value:t.price,onChange:function(a){return e.updateListingLocally(t,a.target.value,t.units)}})),c.a.createElement("td",null,c.a.createElement("input",{type:"text",value:t.units,onChange:function(a){return e.updateListingLocally(t,t.price,a.target.value)}})),c.a.createElement("td",null,t.source),c.a.createElement("td",null,t.timeCreated),c.a.createElement("td",null,c.a.createElement("button",{class:"btn btn-success",onClick:function(){return e.updateListing(t)}},"Update")),c.a.createElement("td",null,c.a.createElement("button",{class:"btn btn-danger",onClick:function(){return e.deleteListing(t)}},"X")))}));return c.a.createElement("div",null,c.a.createElement(E,{token:this.state.token,here:this.props.location.pathname}),c.a.createElement("table",{class:"table table-striped table-hover"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Ingredient Name"),c.a.createElement("th",null,"Price"),c.a.createElement("th",null,"Units"),c.a.createElement("th",null,"Source"),c.a.createElement("th",null,"Time Created"),c.a.createElement("th",null,c.a.createElement("input",{type:"text",class:"form-control",placeholder:"Filter ingredients",value:this.state.ingredientKeyword,onChange:this.setIngredientKeyword})),c.a.createElement("th",null,c.a.createElement("input",{type:"text",class:"form-control",placeholder:"Filter sources",value:this.state.sourceKeyword,onChange:this.setSourceKeyword})))),c.a.createElement("tbody",null,t)),c.a.createElement("p",null,this.state.error))}}]),a}(c.a.Component);d.a.render(c.a.createElement(m.a,null,c.a.createElement("div",null,c.a.createElement(h.d,null,c.a.createElement(h.b,{exact:!0,path:"/login",component:v}),c.a.createElement(h.b,{exact:!0,path:"/newaccount",component:y}),c.a.createElement(h.b,{exact:!0,path:"/newplan",component:I}),c.a.createElement(h.b,{exact:!0,path:"/",component:C}),c.a.createElement(h.b,{exact:!0,path:"/listings",component:j}),c.a.createElement(h.b,{exact:!0,path:"/adminlistings",component:O})))),document.getElementById("root"))},39:function(e,t,a){}},[[33,1,2]]]);
//# sourceMappingURL=main.2a441f75.chunk.js.map