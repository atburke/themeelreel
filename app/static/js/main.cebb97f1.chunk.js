(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{31:function(e,t,n){e.exports=n(32)},32:function(e,t,n){"use strict";n.r(t);var a=n(9),i=n(10),r=n(1),s=n(12),l=n(11),o=n(0),c=n.n(o),u=n(29),d=n.n(u),m=n(15),h=n(2),g=(n(37),n(4)),p=n.n(g);var E=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).toListings=i.toListings.bind(Object(r.a)(i)),i.toMealPlanner=i.toMealPlanner.bind(Object(r.a)(i)),i.toAdminListings=i.toAdminListings.bind(Object(r.a)(i)),i.state={redirect:""},i}return Object(i.a)(n,[{key:"toHome",value:function(e){e.preventDefault(),this.followLink("/")}},{key:"toListings",value:function(e){e.preventDefault(),this.followLink("/listings")}},{key:"toMealPlanner",value:function(e){e.preventDefault(),this.followLink("/newplan")}},{key:"toAdminListings",value:function(e){e.preventDefault(),this.followLink("/adminlistings")}},{key:"followLink",value:function(e){console.log("redirecting to ".concat(e)),e!==this.props.here&&this.setState({redirect:e})}},{key:"render",value:function(){return this.state.redirect?c.a.createElement(h.a,{to:{pathname:this.state.redirect,state:{token:this.props.token}}}):c.a.createElement("nav",null,c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement("a",{href:"/",onClick:this.toHome},"Home")),c.a.createElement("li",null,c.a.createElement("a",{href:"/newplan",onClick:this.toMealPlanner},"New Meal Plan")),c.a.createElement("li",null,c.a.createElement("a",{href:"/listings",onClick:this.toListings},"Listings")),c.a.createElement("li",null,c.a.createElement("a",{href:"/adminlistings",onClick:this.toAdminListings},"Admin listings"))))}}]),n}(c.a.Component),f=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).state={username:"",password:"",redirect:"",token:""},i.props.location.state&&i.props.location.state.token&&(i.state.token=i.props.location.state.token),i.handleUsernameChange=i.handleUsernameChange.bind(Object(r.a)(i)),i.handlePasswordChange=i.handlePasswordChange.bind(Object(r.a)(i)),i.handleSubmit=i.handleSubmit.bind(Object(r.a)(i)),i}return Object(i.a)(n,[{key:"handleUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"handlePasswordChange",value:function(e){this.setState({password:e.target.value})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),p()({method:"get",url:"/api/login",auth:{username:this.state.username,password:this.state.password}}).then((function(e){console.log("logged in!"),t.setState({redirect:"/",token:e.data.token})})).catch((function(e){console.log(e.data),t.setState({error:e.statusText})}))}},{key:"render",value:function(){if(this.state.redirect)return console.log("redirecting to ".concat(this.state.redirect)),c.a.createElement(h.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}});var e=this.state.error?c.a.createElement("p",null,this.state.error):c.a.createElement("p",null);return c.a.createElement("div",null,c.a.createElement("p",null,"Don't have an account? ",c.a.createElement(m.b,{to:"/newaccount"},"Sign up")),e,c.a.createElement("form",{onSubmit:this.handleSubmit},c.a.createElement("label",{htmlFor:"username"},"Username"),c.a.createElement("input",{type:"text",id:"username",value:this.state.username,onChange:this.handleUsernameChange}),c.a.createElement("label",{htmlFor:"password"},"Password"),c.a.createElement("input",{type:"password",id:"password",value:this.state.password,onChange:this.handlePasswordChange}),c.a.createElement("input",{type:"submit",value:"Log in"})))}}]),n}(c.a.Component),v=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).state={username:"",password1:"",password2:"",redirect:""},i.handleUsernameChange=i.handleUsernameChange.bind(Object(r.a)(i)),i.handlePassword1Change=i.handlePassword1Change.bind(Object(r.a)(i)),i.handlePassword2Change=i.handlePassword2Change.bind(Object(r.a)(i)),i.handleSubmit=i.handleSubmit.bind(Object(r.a)(i)),i}return Object(i.a)(n,[{key:"handleUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"handlePassword1Change",value:function(e){this.setState({password1:e.target.value})}},{key:"handlePassword2Change",value:function(e){this.setState({password2:e.target.value}),this.state.password1!==this.state.password2?this.setState({smallError:"Passwords must match"}):this.setState({smallError:""})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.state.username?this.state.password1===this.state.password2?this.state.password1?p()({method:"get",url:"/api/createaccount",auth:{username:this.state.username,password:this.state.password1}}).then((function(e){console.log("redirecting to /"),t.setState({redirect:"/",token:e.data.token})})).catch((function(e){t.setState({error:e.statusText})})):this.setState({smallError:"No password provided"}):this.setState({smallError:"Passwords must match"}):this.setState({smallError:"No username provided"})}},{key:"render",value:function(){if(this.state.redirect)return c.a.createElement(h.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}});var e=this.state.error?c.a.createElement("p",null,this.state.error):c.a.createElement("p",null),t=this.state.smallError?c.a.createElement("p",null,this.state.smallError):c.a.createElement("p",null);return c.a.createElement("div",null,c.a.createElement("p",null,"Already have an account? ",c.a.createElement(m.b,{to:"/login"},"Log in")),e,c.a.createElement("form",{onSubmit:this.handleSubmit},c.a.createElement("label",{htmlFor:"username"},"Username"),c.a.createElement("input",{type:"text",id:"username",value:this.state.username,onChange:this.handleUsernameChange}),c.a.createElement("label",{htmlFor:"password1"},"Password"),c.a.createElement("input",{type:"password",id:"password1",value:this.state.password1,onChange:this.handlePassword1Change}),c.a.createElement("label",{htmlFor:"password2"},"Retype Password"),c.a.createElement("input",{type:"password",id:"password2",value:this.state.password2,onChange:this.handlePassword2Change}),c.a.createElement("input",{type:"submit",value:"Create account"})),t)}}]),n}(c.a.Component);function b(e){return c.a.createElement("div",null,c.a.createElement("div",null,c.a.createElement("div",null,c.a.createElement("a",{href:e.recipeURL},e.name)),c.a.createElement("div",null,e.calories," calories"),c.a.createElement("div",null,"$",e.cost)),c.a.createElement("div",null,c.a.createElement("img",{src:e.imageURL,alt:e.name})))}function k(e){return c.a.createElement("ul",null,e.meals.map((function(e,t){return c.a.createElement("li",{key:t},c.a.createElement(b,{name:e.name,imageURL:e.imageURL,recipeURL:e.recipeURL,cost:e.cost,calories:e.calories}))})))}function S(e){return c.a.createElement("div",null,c.a.createElement("div",null,c.a.createElement("div",null,e.name),c.a.createElement("div",null,e.timeCreated),c.a.createElement("div",null,"Cost: $",e.totalCost),c.a.createElement("div",null,"Total Calories: ",e.totalCalories," (",e.totalCalories/e.recipes.length," calories per day)")),c.a.createElement("div",null,e.recipes.map((function(e,t){return c.a.createElement("div",{key:t},c.a.createElement(k,{meals:e}))}))))}var w=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).state={token:"",redirect:"",error:"",mealPlans:[]},i.props.location.state&&i.props.location.state.token?i.state.token=i.props.location.state.token:i.state.redirect="/login",i.fetchMealPlans(),i}return Object(i.a)(n,[{key:"fetchMealPlans",value:function(){var e=this;p()({method:"get",url:"/api/mealplan",headers:{Authorization:"Bearer ".concat(this.state.token)}}).then((function(t){e.setState({mealPlans:t.data.results})})).catch((function(t){e.setState({error:t.data.error})}))}},{key:"deleteMealPlan",value:function(e){var t=this;p()({method:"delete",url:"/api/mealplan",headers:{Authorization:"Bearer ".concat(this.state.token)},data:{id:e}}).then((function(e){t.fetchMealPlans()})).catch((function(e){t.setState({error:e.data.error})}))}},{key:"render",value:function(){var e=this;return this.state.redirect?c.a.createElement(h.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}}):c.a.createElement("div",null,c.a.createElement(E,{token:this.state.token,here:this.props.location.pathname}),this.state.mealPlans.map((function(t){return c.a.createElement("div",{key:t.id},c.a.createElement(S,{name:t.name,timeCreated:t.timeCreated,totalCost:t.totalCost,totalCalories:t.totalCalories,recipes:t.recipes}),c.a.createElement("button",{onClick:function(){return e.deleteMealPlan(t.id)}},"Delete"))})))}}]),n}(c.a.Component),y=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),console.log("constructing plan meal page"),(i=t.call(this,e)).state={token:"",redirect:"",error:"",msg:"",budget:0,dailyCalories:0,title:"",minIngredients:[],maxIngredients:[],newIngredient:"",newAmount:0,newUnits:"",ingredientSearchResults:[],unitSearchResults:[]},i.props.location.state&&i.props.location.state.token?i.state.token=i.props.location.state.token:i.state.redirect="/login",i.submitPlan=i.submitPlan.bind(Object(r.a)(i)),i.setTitle=i.setTitle.bind(Object(r.a)(i)),i.setBudget=i.setBudget.bind(Object(r.a)(i)),i.setCalories=i.setCalories.bind(Object(r.a)(i)),i.setDays=i.setDays.bind(Object(r.a)(i)),i.updateIngredientSearch=i.updateIngredientSearch.bind(Object(r.a)(i)),i.updateUnitSearch=i.updateUnitSearch.bind(Object(r.a)(i)),i.addMinIngredient=i.addMinIngredient.bind(Object(r.a)(i)),i.deleteMinIngredient=i.deleteMinIngredient.bind(Object(r.a)(i)),i.addMaxIngredient=i.addMaxIngredient.bind(Object(r.a)(i)),i.deleteMaxIngredient=i.deleteMaxIngredient.bind(Object(r.a)(i)),i.setIngredient=i.setIngredient.bind(Object(r.a)(i)),i.setUnits=i.setUnits.bind(Object(r.a)(i)),i.setAmount=i.setAmount.bind(Object(r.a)(i)),i}return Object(i.a)(n,[{key:"setTitle",value:function(e){this.setState({title:e.target.value})}},{key:"setBudget",value:function(e){this.setState({budget:e.target.value})}},{key:"setCalories",value:function(e){this.setState({calories:e.target.value})}},{key:"setDays",value:function(e){this.setState({days:e.target.value})}},{key:"setIngredient",value:function(e){this.setState({newIngredient:e,ingredientSearchResults:[]})}},{key:"setUnits",value:function(e){this.setState({newUnits:e,unitSearchResults:[]})}},{key:"setAmount",value:function(e){this.setState({newAmount:e.target.value})}},{key:"updateIngredientSearch",value:function(e){var t=this,n=e.target.value;p()({method:"get",url:"/api/search/ingredient",params:{kw:n},headers:{Authorization:"Bearer ".concat(this.state.token)}}).then((function(e){t.setState({ingredientSearchResults:e.data.results})}))}},{key:"updateUnitSearch",value:function(e){var t=this,n=e.target.value;p()({method:"get",url:"/api/search/unit",params:{kw:n},headers:{Authorization:"Bearer ".concat(this.state.token)}}).then((function(e){t.setState({unitSearchResults:e.data.results})}))}},{key:"addMinIngredient",value:function(){var e=this;this.state.minIngredients.some((function(t){return t.name===e.state.newIngredient}))||this.setState((function(e,t){return e.minIngredients.push({name:e.newIngredient,amount:e.newAmount,units:e.newUnits}),{minIngredients:e.minIngredients}}))}},{key:"deleteMinIngredient",value:function(e){console.log("deleting ".concat(e," from min")),console.log(this.state.minIngredients),this.setState((function(t,n){return{minIngredients:t.minIngredients.filter((function(t){return t.name!==e}))}}))}},{key:"addMaxIngredient",value:function(){var e=this;this.state.minIngredients.some((function(t){return t.name===e.state.newIngredient}))||this.setState((function(e,t){return e.maxIngredients.push({name:e.newIngredient,amount:e.newAmount,units:e.newUnits}),{maxIngredients:e.maxIngredients}}))}},{key:"deleteMaxIngredient",value:function(e){console.log("deleting ".concat(e," from max")),console.log(this.state.maxIngredients),this.setState((function(t,n){return{maxIngredients:t.maxIngredients.filter((function(t){return t.name!==e}))}}))}},{key:"submitPlan",value:function(e){var t=this;e.preventDefault();var n={budget:this.state.budget,dailyCalories:this.state.dailyCalories,days:this.state.days,title:this.state.title,minIngredients:this.state.minIngredients,maxIngredients:this.state.maxIngredients};p()({method:"post",url:"/api/mealplan",headers:{Authorization:"Basic ".concat(this.state.token)},data:n}).then((function(e){t.setState({msg:e.data.msg})})).catch((function(e){t.setState({error:e.data.error})}))}},{key:"render",value:function(){var e=this;if(console.log("rendering plan meal page"),this.state.redirect)return c.a.createElement(h.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}});var t=this.state.minIngredients.map((function(t){return c.a.createElement("div",{key:t.name},c.a.createElement("span",null,t.name,": ",t.amount," ",t.units),c.a.createElement("button",{onClick:function(){return e.deleteMinIngredient(t.name)}},"X"))})),n=this.state.maxIngredients.map((function(t){return c.a.createElement("div",{key:t.name},c.a.createElement("span",null,t.name,": ",t.amount," ",t.units),c.a.createElement("button",{onClick:function(){return e.deleteMaxIngredient(t.name)}},"X"))}));return c.a.createElement("div",null,c.a.createElement(E,{token:this.state.token,here:this.props.location.pathname}),c.a.createElement("div",null,c.a.createElement("label",{htmlFor:"title"},"Title (optional)"),c.a.createElement("input",{id:"title",type:"text",value:this.state.title,onChange:this.setTitle}),c.a.createElement("label",{htmlFor:"budget"},"Budget"),"$",c.a.createElement("input",{id:"budget",type:"number",min:"0",step:"0.01",value:this.state.budget,onChange:this.setBudget}),c.a.createElement("label",{htmlFor:"calories"},"Daily Calories"),c.a.createElement("input",{id:"calories",type:"number",min:"0",value:this.state.calories,onChange:this.setCalories}),c.a.createElement("label",{htmlFor:"days"},"Days"),c.a.createElement("input",{id:"days",type:"number",min:"1",max:"31",value:this.state.days,onChange:this.setDays}),c.a.createElement("hr",null),c.a.createElement("p",null,"Minimum Ingredients"),t,c.a.createElement("p",null,"Maximum Ingredients"),n,c.a.createElement("hr",null),c.a.createElement("label",{htmlFor:"search-ingr"},"Ingredient"),c.a.createElement("input",{id:"search-ingr",type:"text",onChange:this.updateIngredientSearch}),c.a.createElement("ul",null,this.state.ingredientSearchResults.map((function(t){return c.a.createElement("li",{key:t},c.a.createElement("button",{onClick:function(){return e.setIngredient(t)}},t))}))),c.a.createElement("label",{htmlFor:"search-unit"},"Unit"),c.a.createElement("input",{id:"search-unit",type:"text",onChange:this.updateUnitSearch}),c.a.createElement("ul",null,this.state.unitSearchResults.map((function(t){return c.a.createElement("li",{key:t},c.a.createElement("button",{onClick:function(){return e.setUnits(t)}},t))}))),c.a.createElement("hr",null),c.a.createElement("p",null,this.state.newIngredient),c.a.createElement("label",{htmlFor:"amount"},"Amount:"),c.a.createElement("input",{id:"amount",type:"number",min:"0",step:"0.01",value:this.state.newAmount,onChange:this.setAmount}),c.a.createElement("p",null,this.state.newUnits),c.a.createElement("button",{onClick:this.addMinIngredient},"Add as minimum"),c.a.createElement("button",{onClick:this.addMaxIngredient},"Add as maximum"),c.a.createElement("button",{onClick:this.submitPlan},"Create Plan")))}}]),n}(c.a.Component),C=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),console.log("constructing price listings"),(i=t.call(this,e)).state={ingredientSuggestions:[],unitSuggestions:[],token:"",ingredientSearchTerm:"",unitSearchTerm:"",newIngredientName:"",newIngredientSource:"",newIngredientPrice:0,newIngredientUnits:"",redirect:""},i.props.location.state&&i.props.location.state.token?i.state.token=i.props.location.state.token:i.state.redirect="/login",i.searchIngredient=i.searchIngredient.bind(Object(r.a)(i)),i.searchUnit=i.searchUnit.bind(Object(r.a)(i)),i.fetchNeededPriceListing=i.fetchNeededPriceListing.bind(Object(r.a)(i)),i.setPrice=i.setPrice.bind(Object(r.a)(i)),i.setAmount=i.setAmount.bind(Object(r.a)(i)),i.selectUnits=i.selectUnits.bind(Object(r.a)(i)),i.selectIngredient=i.selectIngredient.bind(Object(r.a)(i)),i.selectSource=i.selectSource.bind(Object(r.a)(i)),i.addPriceListing=i.addPriceListing.bind(Object(r.a)(i)),i}return Object(i.a)(n,[{key:"searchIngredient",value:function(e){var t=this,n=e.target.value;this.setState({ingredientSearchTerm:n}),n?p()({method:"get",url:"/api/search/ingredient",headers:{Authorization:"Bearer ".concat(this.state.token)},params:{kw:n}}).then((function(e){console.log(e.data),t.setState({ingredientSuggestions:e.data.results})})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):t.setState({error:e.data.error})})):this.setState({ingredientSuggestions:[]})}},{key:"searchUnit",value:function(e){var t=this,n=e.target.value;this.setState({unitSearchTerm:n}),n?p()({method:"get",url:"/api/search/unit",headers:{Authorization:"Bearer ".concat(this.state.token)},params:{kw:n}}).then((function(e){console.log(e.data),t.setState({unitSuggestions:e.data.results})})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):t.setState({error:e.data.error})})):this.setState({unitSuggestions:[]})}},{key:"fetchNeededPriceListing",value:function(){var e=this;p()({method:"get",url:"/api/pricelistings",headers:{Authorization:"Bearer ".concat(this.state.token)}}).then((function(t){console.log(t.data),e.setState({newIngredientName:t.data.result,ingredientSuggestions:[]})})).catch((function(t){401===t.status?e.setState({redirect:"/login"}):e.setState({error:t.data.error})}))}},{key:"selectIngredient",value:function(e){this.setState({newIngredientName:e,ingredientSuggestions:[]})}},{key:"selectUnits",value:function(e){this.setState({newIngredientUnits:e,unitSuggestions:[]})}},{key:"selectSource",value:function(e){this.setState({newIngredientSource:e.target.value})}},{key:"setPrice",value:function(e){this.setState({newIngredientPrice:e.target.value})}},{key:"setAmount",value:function(e){this.setState({newIngredientAmount:e.target.value})}},{key:"addPriceListing",value:function(e){var t=this;e&&e.preventDefault();var n={ingredientName:this.state.newIngredientName,price:this.state.newIngredientPrice,amount:this.state.newIngredientAmount,source:this.state.newIngredientSource,units:this.state.newIngredientUnits};["ingredientName","source","units"].forEach((function(e){n[e]||t.setState({error:"Missing field: ".concat(e)})})),n.price<0?this.setState({error:"Price cannot be negative"}):n.amount&&n.amount<0?this.setState({error:"Amount cannot be negative"}):p()({method:"post",url:"/api/pricelistings",headers:{Authorization:"Bearer ".concat(this.state.token)},data:n}).then((function(e){t.setState({error:"",message:"Price for ".concat(n.ingredientName," successfully added!")})})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):t.setState({error:e.data.error})}))}},{key:"render",value:function(){var e,t,n,a=this;return console.log("rendering price listing page"),this.state.redirect?(console.log("redirecting"),c.a.createElement(h.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}})):(this.state.ingredientSuggestions?e=c.a.createElement("ul",null,this.state.ingredientSuggestions.map((function(e){return c.a.createElement("li",null,c.a.createElement("button",{onClick:function(){return a.selectIngredient(e)}},e))}))):this.ingredientOptions=c.a.createElement("div",null),t=this.state.unitSuggestions?c.a.createElement("ul",null,this.state.unitSuggestions.map((function(e){return c.a.createElement("li",null,c.a.createElement("button",{onClick:function(){return a.selectUnits(e)}},e))}))):c.a.createElement("div",null),console.log(this.state),n=this.state.newIngredientName&&this.state.newIngredientUnits?c.a.createElement("div",null,c.a.createElement("form",{onSubmit:this.addPriceListing},c.a.createElement("p",null,this.state.newIngredientName),c.a.createElement("label",{htmlFor:"source"},"Source"),c.a.createElement("input",{type:"text",id:"source",value:this.state.newIngredientSource,onChange:this.selectSource}),c.a.createElement("label",{htmlFor:"price"},"Price"),"$",c.a.createElement("input",{type:"number",id:"price",min:"0",step:"0.01",value:this.state.newIngredientPrice,onChange:this.setPrice}),c.a.createElement("label",{htmlFor:"amount"},"Amount"),c.a.createElement("input",{type:"number",id:"amount",min:"0",step:"0.01",value:this.state.newIngredientAmount,onChange:this.setAmount}),c.a.createElement("p",null,this.state.newIngredientUnits),c.a.createElement("input",{type:"submit",value:"Submit"}))):c.a.createElement("div",null),c.a.createElement("div",null,c.a.createElement(E,{token:this.state.token,here:this.props.location.pathname}),c.a.createElement("label",{htmlFor:"searchIngredient"},"Search for an ingredient to add a price listing for:"),c.a.createElement("input",{id:"searchIngredient",value:this.ingredientSearchTerm,onChange:this.searchIngredient}),e,c.a.createElement("button",{onClick:this.fetchNeededPriceListing},"Choose for me"),c.a.createElement("label",{htmlFor:"searchUnit"},"Select Units"),c.a.createElement("input",{id:"searchUnit",value:this.unitSearchTerm,onChange:this.searchUnit}),t,c.a.createElement("br",null),this.state.newIngredientName?c.a.createElement("p",null,this.state.newIngredientName):"",this.state.newIngredientUnits?c.a.createElement("p",null,this.state.newIngredientUnits):"",c.a.createElement("hr",null),n,this.state.error))}}]),n}(c.a.Component),I=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(e){var i;return Object(a.a)(this,n),(i=t.call(this,e)).state={priceListings:[],token:"",redirect:""},i.props.location.state&&i.props.location.state.token?i.state.token=i.props.location.state.token:i.state.redirect="/login",i.fetchListings(),i}return Object(i.a)(n,[{key:"fetchListings",value:function(){var e=this;p()({method:"get",url:"/api/adminpricelistings",headers:{Authorization:"Bearer ".concat(this.state.token)}}).then((function(t){e.setState({priceListings:t.data.results})})).catch((function(t){401===t.status?e.setState({redirect:"/login"}):403===t.status?e.setState({error:"Not an admin"}):e.setState({error:t.data.error})}))}},{key:"updateListing",value:function(e){var t=this;p()({method:"post",url:"/api/adminpricelistings/update",headers:{Authorization:"Bearer ".concat(this.state.token)},data:{ingredientName:e.ingredientName,source:e.source,timeCreated:e.timeCreated,price:e.price,units:e.units}}).then((function(e){t.fetchListings()})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):403===e.status?t.setState({error:"Not an admin"}):t.setState({error:e.data.error})}))}},{key:"deleteListing",value:function(e){var t=this;p()({method:"post",url:"/api/adminpricelistings/delete",headers:{Authorization:"Bearer ".concat(this.state.token)},data:{ingredientName:e.ingredientName,source:e.source,timeCreated:e.timeCreated}}).then((function(e){t.fetchListings()})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):403===e.status||t.setState({error:e.data.error})}))}},{key:"updateListingLocally",value:function(e,t,n){console.log(e),this.setState({priceListings:this.state.priceListings.map((function(a){return a.ingredientName===e.ingredientName&&a.source===e.source&&a.timeCreated===e.timeCreated?{ingredientName:a.ingredientName,source:a.source,timeCreated:a.timeCreated,price:t,units:n}:a}))})}},{key:"render",value:function(){var e=this;if(this.state.redirect)return console.log("redirecting"),c.a.createElement(h.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}});var t=this.state.priceListings.map((function(t){return c.a.createElement("tr",{key:"".concat(t.ingredientName,":").concat(t.source,":").concat(t.timeCreated)},c.a.createElement("td",null,t.ingredientName),c.a.createElement("td",null,"$",c.a.createElement("input",{type:"number",min:"0",step:"0.01",value:t.price,onChange:function(n){return e.updateListingLocally(t,n.target.value,t.units)}})),c.a.createElement("td",null,c.a.createElement("input",{type:"text",value:t.units,onChange:function(n){return e.updateListingLocally(t,t.price,n.target.value)}})),c.a.createElement("td",null,t.source),c.a.createElement("td",null,t.timeCreated),c.a.createElement("td",null,c.a.createElement("button",{onClick:function(){return e.updateListing(t)}},"Update")),c.a.createElement("td",null,c.a.createElement("button",{onClick:function(){return e.deleteListing(t)}},"X")))}));return c.a.createElement("div",null,c.a.createElement(E,{token:this.state.token,here:this.props.location.pathname}),c.a.createElement("table",null,c.a.createElement("tr",null,c.a.createElement("th",null,"Ingredient Name"),c.a.createElement("th",null,"Price"),c.a.createElement("th",null,"Units"),c.a.createElement("th",null,"Source"),c.a.createElement("th",null,"Time Created"),c.a.createElement("th",null),c.a.createElement("th",null)),t),c.a.createElement("p",null,this.state.error))}}]),n}(c.a.Component);d.a.render(c.a.createElement(m.a,null,c.a.createElement("div",null,c.a.createElement(h.d,null,c.a.createElement(h.b,{exact:!0,path:"/login",component:f}),c.a.createElement(h.b,{exact:!0,path:"/newaccount",component:v}),c.a.createElement(h.b,{exact:!0,path:"/newplan",component:y}),c.a.createElement(h.b,{exact:!0,path:"/",component:w}),c.a.createElement(h.b,{exact:!0,path:"/listings",component:C}),c.a.createElement(h.b,{exact:!0,path:"/adminlistings",component:I})))),document.getElementById("root"))},37:function(e,t,n){}},[[31,1,2]]]);
//# sourceMappingURL=main.cebb97f1.chunk.js.map