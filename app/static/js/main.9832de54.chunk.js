(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{31:function(e,t,n){e.exports=n(32)},32:function(e,t,n){"use strict";n.r(t);var a=n(10),r=n(11),i=n(2),s=n(13),o=n(12),c=n(0),l=n.n(c),u=n(29),d=n.n(u),h=n(15),m=n(1),g=(n(37),n(8)),p=n.n(g);var f=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).toListings=r.toListings.bind(Object(i.a)(r)),r.toMealPlanner=r.toMealPlanner.bind(Object(i.a)(r)),r.toAdminListings=r.toAdminListings.bind(Object(i.a)(r)),r.state={redirect:""},r}return Object(r.a)(n,[{key:"toListings",value:function(e){e.preventDefault(),this.followLink("/listings")}},{key:"toMealPlanner",value:function(e){e.preventDefault(),this.followLink("/")}},{key:"toAdminListings",value:function(e){e.preventDefault(),this.followLink("/adminlistings")}},{key:"followLink",value:function(e){console.log("redirecting to ".concat(e)),this.setState({redirect:e})}},{key:"render",value:function(){return this.state.redirect?l.a.createElement(m.a,{to:{pathname:this.state.redirect,state:{token:this.props.token}}}):l.a.createElement("nav",null,l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("a",{href:"/",onClick:this.toMealPlanner},"Meal Planner")),l.a.createElement("li",null,l.a.createElement("a",{href:"/listings",onClick:this.toListings},"Listings")),l.a.createElement("li",null,l.a.createElement("a",{href:"/adminlistings",onClick:this.toAdminListings},"Admin listings"))))}}]),n}(l.a.Component),E=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={username:"",password:"",redirect:"",token:""},r.props.location.state&&r.props.location.state.token&&(r.state.token=r.props.location.state.token),r.handleUsernameChange=r.handleUsernameChange.bind(Object(i.a)(r)),r.handlePasswordChange=r.handlePasswordChange.bind(Object(i.a)(r)),r.handleSubmit=r.handleSubmit.bind(Object(i.a)(r)),r}return Object(r.a)(n,[{key:"handleUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"handlePasswordChange",value:function(e){this.setState({password:e.target.value})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),p()({method:"get",url:"/api/login",auth:{username:this.state.username,password:this.state.password}}).then((function(e){console.log("logged in!"),t.setState({redirect:"/",token:e.data.token})})).catch((function(e){t.setState({error:e.statusText})}))}},{key:"render",value:function(){if(this.state.redirect)return console.log("redirecting to ".concat(this.state.redirect)),l.a.createElement(m.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}});var e=this.state.error?l.a.createElement("p",null,this.state.error):l.a.createElement("p",null);return l.a.createElement("div",null,l.a.createElement("p",null,"Don't have an account? ",l.a.createElement(h.b,{to:"/newaccount"},"Sign up")),e,l.a.createElement("form",{onSubmit:this.handleSubmit},l.a.createElement("label",{htmlFor:"username"},"Username"),l.a.createElement("input",{type:"text",id:"username",value:this.state.username,onChange:this.handleUsernameChange}),l.a.createElement("label",{htmlFor:"password"},"Password"),l.a.createElement("input",{type:"password",id:"password",value:this.state.password,onChange:this.handlePasswordChange}),l.a.createElement("input",{type:"submit",value:"Log in"})))}}]),n}(l.a.Component),v=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={username:"",password1:"",password2:"",redirect:""},r.handleUsernameChange=r.handleUsernameChange.bind(Object(i.a)(r)),r.handlePassword1Change=r.handlePassword1Change.bind(Object(i.a)(r)),r.handlePassword2Change=r.handlePassword2Change.bind(Object(i.a)(r)),r.handleSubmit=r.handleSubmit.bind(Object(i.a)(r)),r}return Object(r.a)(n,[{key:"handleUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"handlePassword1Change",value:function(e){this.setState({password1:e.target.value})}},{key:"handlePassword2Change",value:function(e){this.setState({password2:e.target.value}),this.state.password1!==this.state.password2?this.setState({smallError:"Passwords must match"}):this.setState({smallError:""})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.state.username?this.state.password1===this.state.password2?this.state.password1?p()({method:"get",url:"/api/createaccount",auth:{username:this.state.username,password:this.state.password1}}).then((function(e){console.log("redirecting to /"),t.setState({redirect:"/",token:e.data.token})})).catch((function(e){t.setState({error:e.statusText})})):this.setState({smallError:"No password provided"}):this.setState({smallError:"Passwords must match"}):this.setState({smallError:"No username provided"})}},{key:"render",value:function(){if(this.state.redirect)return l.a.createElement(m.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}});var e=this.state.error?l.a.createElement("p",null,this.state.error):l.a.createElement("p",null),t=this.state.smallError?l.a.createElement("p",null,this.state.smallError):l.a.createElement("p",null);return l.a.createElement("div",null,l.a.createElement("p",null,"Already have an account? ",l.a.createElement(h.b,{to:"/login"},"Log in")),e,l.a.createElement("form",{onSubmit:this.handleSubmit},l.a.createElement("label",{htmlFor:"username"},"Username"),l.a.createElement("input",{type:"text",id:"username",value:this.state.username,onChange:this.handleUsernameChange}),l.a.createElement("label",{htmlFor:"password1"},"Password"),l.a.createElement("input",{type:"password",id:"password1",value:this.state.password1,onChange:this.handlePassword1Change}),l.a.createElement("label",{htmlFor:"password2"},"Retype Password"),l.a.createElement("input",{type:"password",id:"password2",value:this.state.password2,onChange:this.handlePassword2Change}),l.a.createElement("input",{type:"submit",value:"Create account"})),t)}}]),n}(l.a.Component),b=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),console.log("constructing plan meal page"),(r=t.call(this,e)).state={token:"",redirect:""},r.props.location.state&&r.props.location.state.token?r.state.token=r.props.location.state.token:r.state.redirect="/login",r}return Object(r.a)(n,[{key:"render",value:function(){return console.log("rendering plan meal page"),this.state.redirect?l.a.createElement(m.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}}):l.a.createElement("div",null,l.a.createElement(f,{token:this.state.token}),l.a.createElement("p",null,"NOTHING TO SEE HERE"))}}]),n}(l.a.Component),k=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),console.log("constructing price listings"),(r=t.call(this,e)).state={ingredientSuggestions:[],unitSuggestions:[],token:"",ingredientSearchTerm:"",unitSearchTerm:"",newIngredientName:"",newIngredientSource:"",newIngredientPrice:0,newIngredientUnits:"",redirect:""},r.props.location.state&&r.props.location.state.token?r.state.token=r.props.location.state.token:r.state.redirect="/login",r.searchIngredient=r.searchIngredient.bind(Object(i.a)(r)),r.searchUnit=r.searchUnit.bind(Object(i.a)(r)),r.fetchNeededPriceListing=r.fetchNeededPriceListing.bind(Object(i.a)(r)),r.setPrice=r.setPrice.bind(Object(i.a)(r)),r.selectUnits=r.selectUnits.bind(Object(i.a)(r)),r.selectIngredient=r.selectIngredient.bind(Object(i.a)(r)),r.selectSource=r.selectSource.bind(Object(i.a)(r)),r.addPriceListing=r.addPriceListing.bind(Object(i.a)(r)),r}return Object(r.a)(n,[{key:"searchIngredient",value:function(e){var t=this,n=e.target.value;this.setState({ingredientSearchTerm:n}),n?p()({method:"get",url:"/api/search/ingredient",headers:{Authorization:"Bearer ".concat(this.state.token)},params:{kw:n}}).then((function(e){console.log(e.data),t.setState({ingredientSuggestions:e.data.results})})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):t.setState({error:e.data.error})})):this.setState({ingredientSuggestions:[]})}},{key:"searchUnit",value:function(e){var t=this,n=e.target.value;this.setState({unitSearchTerm:n}),n?p()({method:"get",url:"/api/search/unit",headers:{Authorization:"Bearer ".concat(this.state.token)},params:{kw:n}}).then((function(e){console.log(e.data),t.setState({unitSuggestions:e.data.results})})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):t.setState({error:e.data.error})})):this.setState({unitSuggestions:[]})}},{key:"fetchNeededPriceListing",value:function(){var e=this;p()({method:"get",url:"/api/pricelistings",headers:{Authorization:"Bearer ".concat(this.state.token)}}).then((function(t){console.log(t.data),e.setState({newIngredientName:t.data.result,ingredientSuggestions:[]})})).catch((function(t){401===t.status?e.setState({redirect:"/login"}):e.setState({error:t.data.error})}))}},{key:"selectIngredient",value:function(e){this.setState({newIngredientName:e,ingredientSuggestions:[]})}},{key:"selectUnits",value:function(e){this.setState({newIngredientUnits:e,unitSuggestions:[]})}},{key:"selectSource",value:function(e){this.setState({newIngredientSource:e.target.value})}},{key:"setPrice",value:function(e){this.setState({newIngredientPrice:e.target.value})}},{key:"addPriceListing",value:function(e){var t=this;e&&e.preventDefault();var n={ingredientName:this.state.newIngredientName,price:this.state.newIngredientPrice,source:this.state.newIngredientSource,units:this.state.newIngredientUnits};["ingredientName","source","units"].forEach((function(e){n[e]||t.setState({error:"Missing field: ".concat(e)})})),n.price<0?this.setState({error:"Price cannot be negative"}):p()({method:"post",url:"/api/pricelistings",headers:{Authorization:"Bearer ".concat(this.state.token)},data:n}).then((function(e){t.setState({error:"",message:"Price for ".concat(n.ingredientName," successfully added!")})})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):t.setState({error:e.data.error})}))}},{key:"render",value:function(){var e,t,n,a=this;return console.log("rendering price listing page"),this.state.redirect?(console.log("redirecting"),l.a.createElement(m.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}})):(this.state.ingredientOptions?e=l.a.createElement("ul",null,this.ingredientSuggestions.map((function(e){return l.a.createElement("li",null,l.a.createElement("button",{onClick:function(){return a.selectIngredient(e)}},e))}))):this.ingredientOptions=l.a.createElement("div",null),t=this.state.unitOptions?l.a.createElement("ul",null,this.unitSuggestions.map((function(e){return l.a.createElement("li",null,l.a.createElement("button",{onClick:function(){return a.selectUnits(e)}},e))}))):l.a.createElement("div",null),console.log(this.state),n=this.state.newIngredientName?l.a.createElement("div",null,l.a.createElement("form",{onSubmit:this.addPriceListing},l.a.createElement("p",null,this.state.newIngredientName),l.a.createElement("input",{type:"text",value:this.state.newIngredientSource,onChange:this.selectSource}),l.a.createElement("input",{type:"number",min:"0",step:"0.01",value:this.state.newIngredientPrice,onChange:this.setPrice}),l.a.createElement("p",null,this.state.newIngredientUnits),l.a.createElement("input",{type:"submit",value:"Submit"}))):l.a.createElement("div",null),l.a.createElement("div",null,l.a.createElement(f,{token:this.state.token}),l.a.createElement("label",{htmlFor:"searchIngredient"},"Search for an ingredient to add a price listing for:"),l.a.createElement("input",{id:"searchIngredient",value:this.ingredientSearchTerm,onChange:this.searchIngredient}),e,l.a.createElement("button",{onClick:this.fetchNeededPriceListing},"Choose for me"),l.a.createElement("label",{htmlFor:"searchUnit"},"Select Units"),l.a.createElement("input",{id:"searchUnit",value:this.unitSearchTerm,onChange:this.searchUnit}),t,l.a.createElement("hr",null),n,this.state.error))}}]),n}(l.a.Component),S=function(e){Object(s.a)(n,e);var t=Object(o.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e)).state={priceListings:[],token:"",redirect:""},r.props.location.state&&r.props.location.state.token?r.setState({token:r.props.location.state.token}):r.setState({redirect:"/login"}),r.fetchListings(),r}return Object(r.a)(n,[{key:"fetchListings",value:function(){var e=this;p()({method:"get",url:"/api/adminpricelistings",headers:{Authorization:"Bearer ".concat(this.state.token)}}).then((function(t){e.setState({priceListings:t.data.priceListings})})).catch((function(t){401===t.status?e.setState({redirect:"/login"}):403===t.status||e.setState({error:t.data.error})}))}},{key:"updateListing",value:function(e){var t=this;p()({method:"post",url:"/api/adminpricelistings/update",headers:{Authorization:"Bearer ".concat(this.state.token)},data:{update:{ingredientName:e.ingredientName,source:e.source,timeCreated:e.timeCreated},set:{price:e.price}}}).then((function(e){t.fetchListings()})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):403===e.status||t.setState({error:e.data.error})}))}},{key:"deleteListing",value:function(e){var t=this;p()({method:"post",url:"/api/adminpricelistings/delete",headers:{Authorization:"Bearer ".concat(this.state.token)},data:{ingredientName:e.ingredientName,source:e.source,timeCreated:e.timeCreated}}).then((function(e){t.fetchListings()})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):403===e.status||t.setState({error:e.data.error})}))}},{key:"updateListingLocally",value:function(e){this.setState({priceListings:this.state.priceListings.map((function(t){return t.ingredientName===e.ingredientName&&t.source===e.source&&t.timeCreated===e.timeCreated?{ingredientName:t.ingredientName,source:t.source,timeCreated:t.timeCreated,price:e.price,units:e.units}:t}))})}},{key:"render",value:function(){var e=this;if(this.state.redirect)return console.log("redirecting"),l.a.createElement(m.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}});var t=this.state.priceListings.map((function(t){return l.a.createElement("tr",{key:"".concat(t.ingredientName,":").concat(t.source,":").concat(t.timeCreated)},l.a.createElement("td",null,t.ingredientName),l.a.createElement("td",null,"$",l.a.createElement("input",{type:"number",min:"0",step:"0.01",value:t.price,onChange:function(){return e.updateListingLocally(t)}})),l.a.createElement("td",null,l.a.createElement("input",{type:"text",value:t.units,onChange:function(){return e.updateListingLocally(t)}})),l.a.createElement("td",null,t.source),l.a.createElement("td",null,t.timeCreated),l.a.createElement("td",null,l.a.createElement("button",{onClick:function(){return e.updateListing(t)}},"Update")),l.a.createElement("td",null,l.a.createElement("button",{onClick:function(){return e.deleteListing(t)}},"X")))}));return l.a.createElement("div",null,l.a.createElement(f,{token:this.state.token}),l.a.createElement("table",null,t),l.a.createElement("p",null,this.state.error))}}]),n}(l.a.Component);d.a.render(l.a.createElement(h.a,null,l.a.createElement("div",null,l.a.createElement(m.d,null,l.a.createElement(m.b,{exact:!0,path:"/login",component:E}),l.a.createElement(m.b,{exact:!0,path:"/newaccount",component:v}),l.a.createElement(m.b,{exact:!0,path:"/",component:b}),l.a.createElement(m.b,{exact:!0,path:"/listings",component:k}),l.a.createElement(m.b,{exact:!0,path:"/adminlistings",component:S})))),document.getElementById("root"))},37:function(e,t,n){}},[[31,1,2]]]);
//# sourceMappingURL=main.9832de54.chunk.js.map