(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{31:function(e,t,a){e.exports=a(32)},32:function(e,t,a){"use strict";a.r(t);var n=a(3),r=a(10),i=a(11),s=a(13),c=a(12),l=a(0),o=a.n(l),u=a(29),d=a.n(u),h=a(14),m=a(1),g=(a(37),a(8)),p=a.n(g);var E=function(e){Object(s.a)(a,e);var t=Object(c.a)(a);function a(){return Object(r.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return o.a.createElement("nav",null,o.a.createElement("ul",null,o.a.createElement("li",null,o.a.createElement(h.b,{to:{pathname:"/",state:{token:this.props.token}}},"Meal Planner")),o.a.createElement("li",null,o.a.createElement(h.b,{to:{pathname:"/listings",state:{token:this.props.token}}},"Price Listings"))))}}]),a}(o.a.Component),b=function(e){Object(s.a)(a,e);var t=Object(c.a)(a);function a(e){var i;return Object(r.a)(this,a),(i=t.call(this,e)).state={username:"",password:""},i.props.location&&i.setState({token:i.props.location.state.token}),i.handleUsernameChange=i.handleUsernameChange.bind(Object(n.a)(i)),i.handlePasswordChange=i.handlePasswordChange.bind(Object(n.a)(i)),i.handleSubmit=i.handleSubmit.bind(Object(n.a)(i)),i}return Object(i.a)(a,[{key:"handleUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"handlePasswordChange",value:function(e){this.setState({password:e.target.value})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),p()({method:"get",url:"/api/login",auth:{username:this.state.username,password:this.state.password}}).then((function(e){t.setState({redirect:"/",token:e.data.token})})).catch((function(e){t.setState({error:e.statusText})}))}},{key:"render",value:function(){if(this.state.redirect)return o.a.createElement(m.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}});var e=this.state.error?o.a.createElement("p",null,this.state.error):o.a.createElement("p",null);return o.a.createElement("div",null,o.a.createElement("p",null,"Don't have an account? ",o.a.createElement(h.b,{to:"/newaccount"},"Sign up")),e,o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement("label",{htmlFor:"username"},"Username"),o.a.createElement("input",{type:"text",id:"username",value:this.state.username,onChange:this.handleUsernameChange}),o.a.createElement("label",{htmlFor:"password"},"Password"),o.a.createElement("input",{type:"password",id:"password",value:this.state.password,onChange:this.handlePasswordChange}),o.a.createElement("input",{type:"submit",value:"Log in"})))}}]),a}(o.a.Component),f=function(e){Object(s.a)(a,e);var t=Object(c.a)(a);function a(e){var i;return Object(r.a)(this,a),(i=t.call(this,e)).state={username:"",password1:"",password2:""},i.handleUsernameChange=i.handleUsernameChange.bind(Object(n.a)(i)),i.handlePassword1Change=i.handlePassword1Change.bind(Object(n.a)(i)),i.handlePassword2Change=i.handlePassword2Change.bind(Object(n.a)(i)),i.handleSubmit=i.handleSubmit.bind(Object(n.a)(i)),i}return Object(i.a)(a,[{key:"handleUsernameChange",value:function(e){this.setState({username:e.target.value})}},{key:"handlePassword1Change",value:function(e){this.setState({password1:e.target.value})}},{key:"handlePassword2Change",value:function(e){this.setState({password2:e.target.value}),this.state.password1!==this.state.password2?this.setState({smallError:"Passwords must match"}):this.setState({smallError:""})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.state.username?this.state.password1===this.state.password2?this.state.password1?p()({method:"post",url:"/api/createaccount",data:{username:this.state.username,password:this.state.password}}).then((function(e){t.setState({redirect:"/",token:e.data.token})})).catch((function(e){t.setState({error:e.statusText})})):this.setState({smallError:"No password provided"}):this.setState({smallError:"Passwords must match"}):this.setState({smallError:"No username provided"})}},{key:"render",value:function(){if(this.state.redirect)return o.a.createElement(m.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}});var e=this.state.error?o.a.createElement("p",null,this.state.error):o.a.createElement("p",null),t=this.state.smallError?o.a.createElement("p",null,this.state.smallError):o.a.createElement("p",null);return o.a.createElement("div",null,o.a.createElement("p",null,"Already have an account? ",o.a.createElement(h.b,{to:"/login"},"Log in")),e,o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement("label",{htmlFor:"username"},"Username"),o.a.createElement("input",{type:"text",id:"username",value:this.state.username,onChange:this.handleUsernameChange}),o.a.createElement("label",{htmlFor:"password1"},"Password"),o.a.createElement("input",{type:"password",id:"password1",value:this.state.password1,onChange:this.handlePassword1Change}),o.a.createElement("label",{htmlFor:"password2"},"Retype Password"),o.a.createElement("input",{type:"password",id:"password2",value:this.state.password2,onChange:this.handlePassword2Change}),o.a.createElement("input",{type:"submit",value:"Create account"})),t)}}]),a}(o.a.Component),v=function(e){Object(s.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={token:""},n}return Object(i.a)(a,[{key:"render",value:function(){return this.state.redirect?o.a.createElement(m.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}}):o.a.createElement("div",null,o.a.createElement(E,{token:this.state.token}),o.a.createElement("p",null,"NOTHING TO SEE HERE"))}}]),a}(o.a.Component),S=function(e){Object(s.a)(a,e);var t=Object(c.a)(a);function a(e){var i;return Object(r.a)(this,a),(i=t.call(this,e)).state={ingredientSuggestions:[],unitSuggestions:[],token:"",ingredientSearchTerm:"",unitSearchTerm:"",newIngredientName:"",newIngredientSource:"",newIngredientPrice:0,newIngredientUnits:""},i.searchIngredient=i.searchIngredient.bind(Object(n.a)(i)),i.searchUnit=i.searchUnit.bind(Object(n.a)(i)),i.fetchNeededPriceListing=i.fetchNeededPriceListing.bind(Object(n.a)(i)),i.setPrice=i.setPrice.bind(Object(n.a)(i)),i.selectUnits=i.selectUnits.bind(Object(n.a)(i)),i.selectIngredient=i.selectIngredient.bind(Object(n.a)(i)),i.selectSource=i.selectSource.bind(Object(n.a)(i)),i.addPriceListing=i.addPriceListing.bind(Object(n.a)(i)),i}return Object(i.a)(a,[{key:"searchIngredient",value:function(e){var t=this,a=e.target.value;this.setState({ingredientSearchTerm:a}),a?p()({method:"get",url:"/api/search/ingredient",headers:{Authorization:"Bearer ".concat(this.state.token)},params:{kw:a}}).then((function(e){t.setState({ingredientSuggestions:e.data.results})})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):t.setState({error:e.data.error})})):this.setState({ingredientSuggestions:[]})}},{key:"searchUnit",value:function(e){var t=this,a=e.target.value;this.setState({unitSearchTerm:a}),a?p()({method:"get",url:"/api/search/unit",headers:{Authorization:"Bearer ".concat(this.state.token)},params:{kw:a}}).then((function(e){t.setState({unitSuggestions:e.data.results})})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):t.setState({error:e.data.error})})):this.setState({unitSuggestions:[]})}},{key:"fetchNeededPriceListing",value:function(){var e=this;p()({method:"get",url:"/api/pricelistings",headers:{Authorization:"Bearer ".concat(this.state.token)}}).then((function(t){e.setState({newIngredientName:t.data.ingredientName,ingredientSuggestions:[]})})).catch((function(t){401===t.status?e.setState({redirect:"/login"}):e.setState({error:t.data.error})}))}},{key:"selectIngredient",value:function(e){this.setState({newIngredientName:e,ingredientSuggestions:[]})}},{key:"selectUnits",value:function(e){this.setState({newIngredientUnits:e,unitSuggestions:[]})}},{key:"selectSource",value:function(e){this.setState({newIngredientSource:e.target.value})}},{key:"setPrice",value:function(e){this.setState({newIngredientPrice:e.target.value})}},{key:"addPriceListing",value:function(e){var t=this;e&&e.preventDefault();var a={ingredientName:this.state.newIngredientName,price:this.state.newIngredientPrice,source:this.state.newIngredientSource,units:this.state.newIngredientUnits};["ingredientName","source","units"].forEach((function(e){a[e]||t.setState({error:"Missing field: ".concat(e)})})),a.price<0?this.setState({error:"Price cannot be negative"}):p()({method:"post",url:"/api/pricelistings",headers:{Authorization:"Bearer ".concat(this.state.token)},data:a}).then((function(e){t.setState({error:"",message:"Price for ".concat(a.ingredientName," successfully added!")})})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):t.setState({error:e.data.error})}))}},{key:"render",value:function(){var e,t,a,n=this;return this.state.redirect?o.a.createElement(m.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}}):(this.state.ingredientOptions?e=o.a.createElement("ul",null,this.ingredientSuggestions.map((function(e){return o.a.createElement("li",null,o.a.createElement("button",{onClick:function(){return n.selectIngredient(e)}},e))}))):this.ingredientOptions=o.a.createElement("div",null),t=this.state.unitOptions?o.a.createElement("ul",null,this.unitSuggestions.map((function(e){return o.a.createElement("li",null,o.a.createElement("button",{onClick:function(){return n.selectUnits(e)}},e))}))):o.a.createElement("div",null),a=this.state.newIngredientName?o.a.createElement("div",null,o.a.createElement("form",{onSubmit:this.addPriceListing},o.a.createElement("p",null,this.state.newIngredientName),o.a.createElement("input",{type:"text",value:this.state.newIngredientSource,onChange:this.selectSource}),o.a.createElement("input",{type:"number",min:"0",step:"0.01",value:this.state.newIngredientPrice,onChange:this.setPrice}),o.a.createElement("p",null,this.state.newIngredientUnits),o.a.createElement("input",{type:"submit",value:"Submit"}))):o.a.createElement("div",null),o.a.createElement("div",null,o.a.createElement(E,{token:this.state.token}),o.a.createElement("label",{htmlFor:"searchIngredient"},"Search for an ingredient to add a price listing for:"),o.a.createElement("input",{id:"searchIngredient",value:this.ingredientSearchTerm,onChange:this.searchIngredient}),e,o.a.createElement("button",{onClick:this.fetchNeededPriceListing},"Choose for me"),o.a.createElement("label",{htmlFor:"searchUnit"},"Select Units"),o.a.createElement("input",{id:"searchUnit",value:this.unitSearchTerm,onChange:this.searchUnit}),t,o.a.createElement("hr",null),a,this.state.error))}}]),a}(o.a.Component),k=function(e){Object(s.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={priceListings:[],token:""},n.props.location&&n.setState({token:n.props.location.state.token}),n.fetchListings(),n}return Object(i.a)(a,[{key:"fetchListings",value:function(){var e=this;p()({method:"get",url:"/api/adminpricelistings",headers:{Authorization:"Bearer ".concat(this.state.token)}}).then((function(t){e.setState({priceListings:t.data.priceListings})})).catch((function(t){401===t.status?e.setState({redirect:"/login"}):403===t.status||e.setState({error:t.data.error})}))}},{key:"updateListing",value:function(e){var t=this;p()({method:"post",url:"/api/adminpricelistings/update",headers:{Authorization:"Bearer ".concat(this.state.token)},data:{update:{ingredientName:e.ingredientName,source:e.source,timeCreated:e.timeCreated},set:{price:e.price}}}).then((function(e){t.fetchListings()})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):403===e.status||t.setState({error:e.data.error})}))}},{key:"deleteListing",value:function(e){var t=this;p()({method:"post",url:"/api/adminpricelistings/delete",headers:{Authorization:"Bearer ".concat(this.state.token)},data:{ingredientName:e.ingredientName,source:e.source,timeCreated:e.timeCreated}}).then((function(e){t.fetchListings()})).catch((function(e){401===e.status?t.setState({redirect:"/login"}):403===e.status||t.setState({error:e.data.error})}))}},{key:"updateListingLocally",value:function(e){this.setState({priceListings:this.state.priceListings.map((function(t){return t.ingredientName===e.ingredientName&&t.source===e.source&&t.timeCreated===e.timeCreated?{ingredientName:t.ingredientName,source:t.source,timeCreated:t.timeCreated,price:e.price,units:e.units}:t}))})}},{key:"render",value:function(){var e=this;if(this.state.redirect)return o.a.createElement(m.a,{to:{pathname:this.state.redirect,state:{token:this.state.token}}});var t=this.state.priceListings.map((function(t){return o.a.createElement("tr",{key:"".concat(t.ingredientName,":").concat(t.source,":").concat(t.timeCreated)},o.a.createElement("td",null,t.ingredientName),o.a.createElement("td",null,"$",o.a.createElement("input",{type:"number",min:"0",step:"0.01",value:t.price,onChange:function(){return e.updateListingLocally(t)}})),o.a.createElement("td",null,o.a.createElement("input",{type:"text",value:t.units,onChange:function(){return e.updateListingLocally(t)}})),o.a.createElement("td",null,t.source),o.a.createElement("td",null,t.timeCreated),o.a.createElement("td",null,o.a.createElement("button",{onClick:function(){return e.updateListing(t)}},"Update")),o.a.createElement("td",null,o.a.createElement("button",{onClick:function(){return e.deleteListing(t)}},"X")))}));return o.a.createElement("div",null,o.a.createElement(E,{token:this.state.token}),o.a.createElement("table",null,t),o.a.createElement("p",null,this.state.error))}}]),a}(o.a.Component);d.a.render(o.a.createElement(h.a,null,o.a.createElement("div",null,o.a.createElement(m.d,null,o.a.createElement(m.b,{path:"/login"},o.a.createElement(b,null)),o.a.createElement(m.b,{path:"/newaccount"},o.a.createElement(f,null)),o.a.createElement(m.b,{path:"/"},o.a.createElement(v,null)),o.a.createElement(m.b,{path:"/listings"},o.a.createElement(S,null)),o.a.createElement(m.b,{path:"/adminlistings"},o.a.createElement(k,null))))),document.getElementById("root"))},37:function(e,t,a){}},[[31,1,2]]]);
//# sourceMappingURL=main.38f09997.chunk.js.map